"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[443],{936(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"architecture","title":"Architecture","description":"This document describes the internal architecture of X-Skynet, the relationships between packages, and the key design decisions that shape the framework.","source":"@site/docs/architecture.md","sourceDirName":".","slug":"/architecture","permalink":"/x-skynet/docs/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/ds0857/x-skynet/tree/main/website/docs/architecture.md","tags":[],"version":"current","frontMatter":{"id":"architecture","title":"Architecture","sidebar_label":"Architecture"},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/x-skynet/docs/intro"},"next":{"title":"Plugin Development","permalink":"/x-skynet/docs/plugin-development"}}');var i=s(4848),r=s(8453);const c={id:"architecture",title:"Architecture",sidebar_label:"Architecture"},l="X-Skynet Architecture",d={},o=[{value:"Repository Structure",id:"repository-structure",level:2},{value:"Core Package (<code>@x-skynet/core</code>)",id:"core-package-x-skynetcore",level:2},{value:"Agent Lifecycle",id:"agent-lifecycle",level:3},{value:"Runtime",id:"runtime",level:3},{value:"Message Bus",id:"message-bus",level:3},{value:"Plugin Registry",id:"plugin-registry",level:3},{value:"CLI Package (<code>@x-skynet/cli</code>)",id:"cli-package-x-skynetcli",level:2},{value:"Types Package (<code>@x-skynet/types</code>)",id:"types-package-x-skynettypes",level:2},{value:"Plugin System",id:"plugin-system",level:2},{value:"Data Flow",id:"data-flow",level:2},{value:"Design Principles",id:"design-principles",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"x-skynet-architecture",children:"X-Skynet Architecture"})}),"\n",(0,i.jsx)(n.p,{children:"This document describes the internal architecture of X-Skynet, the relationships between packages, and the key design decisions that shape the framework."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"repository-structure",children:"Repository Structure"}),"\n",(0,i.jsxs)(n.p,{children:["X-Skynet is a ",(0,i.jsx)(n.strong,{children:"pnpm monorepo"})," containing multiple packages under a single repository:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"x-skynet/\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 core/                    # @x-skynet/core\n\u2502   \u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 agent.ts         # Agent class & lifecycle\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 runtime.ts       # Runtime orchestrator\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 message-bus.ts   # Inter-agent messaging\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 plugin-registry.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 task-scheduler.ts\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 memory/          # Memory subsystem\n\u2502   \u2502   \u2514\u2500\u2500 package.json\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 cli/                     # @x-skynet/cli\n\u2502   \u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 commands/        # CLI commands (init, run, list...)\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.ts\n\u2502   \u2502   \u2514\u2500\u2500 package.json\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 types/                   # @x-skynet/types\n\u2502   \u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 agent.types.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 plugin.types.ts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 message.types.ts\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 index.ts\n\u2502   \u2502   \u2514\u2500\u2500 package.json\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 plugins/\n\u2502       \u251c\u2500\u2500 openai/              # @x-skynet/plugin-openai\n\u2502       \u251c\u2500\u2500 anthropic/           # @x-skynet/plugin-anthropic\n\u2502       \u251c\u2500\u2500 qwen/                # @x-skynet/plugin-qwen\n\u2502       \u2514\u2500\u2500 memory/              # @x-skynet/plugin-memory\n\u2502\n\u251c\u2500\u2500 templates/                   # Project templates for `x-skynet init`\n\u251c\u2500\u2500 examples/                    # Runnable example projects\n\u251c\u2500\u2500 docs/                        # Internal developer notes\n\u251c\u2500\u2500 website/                     # This Docusaurus site\n\u251c\u2500\u2500 pnpm-workspace.yaml\n\u2514\u2500\u2500 package.json\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"core-package-x-skynetcore",children:["Core Package (",(0,i.jsx)(n.code,{children:"@x-skynet/core"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"The core package is the foundation of the framework. It provides:"}),"\n",(0,i.jsx)(n.h3,{id:"agent-lifecycle",children:"Agent Lifecycle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agent Created \u2192 Configured \u2192 Registered \u2192 Ready \u2192 Running \u2192 Done\n                                           \u2191              |\n                                           \u2514\u2500\u2500\u2500\u2500 Retry \u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsxs)(n.p,{children:["An ",(0,i.jsx)(n.code,{children:"Agent"})," instance encapsulates:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Identity"}),": name, description, model selection"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"System prompt"}),": base instructions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Plugin list"}),": ordered list of capability plugins"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Memory"}),": optional persistent memory adapter"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Hooks"}),": ",(0,i.jsx)(n.code,{children:"onMessage"}),", ",(0,i.jsx)(n.code,{children:"onError"}),", ",(0,i.jsx)(n.code,{children:"onComplete"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"runtime",children:"Runtime"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Runtime"})," is the central orchestrator:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"class Runtime {\n  agents: Map<string, Agent>;\n  bus: MessageBus;\n  registry: PluginRegistry;\n\n  async send(message: AgentMessage): Promise<AgentResponse>;\n  async pipeline(steps: PipelineStep[]): Promise<PipelineResult>;\n  async broadcast(message: string): Promise<AgentResponse[]>;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"The runtime:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Receives incoming messages"}),"\n",(0,i.jsx)(n.li,{children:"Routes them to the appropriate agent"}),"\n",(0,i.jsx)(n.li,{children:"Executes the agent's plugin chain"}),"\n",(0,i.jsx)(n.li,{children:"Calls the LLM provider plugin"}),"\n",(0,i.jsx)(n.li,{children:"Returns the response"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"message-bus",children:"Message Bus"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"MessageBus"})," handles inter-agent communication:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Mode"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sequential"})}),(0,i.jsx)(n.td,{children:"Agents process messages one at a time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"parallel"})}),(0,i.jsx)(n.td,{children:"Agents run concurrently"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"pipeline"})}),(0,i.jsx)(n.td,{children:"Output of one agent feeds the next"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"broadcast"})}),(0,i.jsx)(n.td,{children:"Message sent to all registered agents"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"plugin-registry",children:"Plugin Registry"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"PluginRegistry"})," manages installed plugins:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"class PluginRegistry {\n  register(plugin: XSkynetPlugin): void;\n  get(id: string): XSkynetPlugin | undefined;\n  list(): XSkynetPlugin[];\n  has(id: string): boolean;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"cli-package-x-skynetcli",children:["CLI Package (",(0,i.jsx)(n.code,{children:"@x-skynet/cli"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"The CLI wraps the core for developer ergonomics. It provides:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Command"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"x-skynet init <name>"})}),(0,i.jsx)(n.td,{children:"Scaffold a new agent project"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"x-skynet run <file>"})}),(0,i.jsx)(n.td,{children:"Run an agent definition file"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"x-skynet list"})}),(0,i.jsx)(n.td,{children:"List registered agents in current project"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"x-skynet inspect <agent>"})}),(0,i.jsx)(n.td,{children:"Show agent config and plugin chain"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"x-skynet build"})}),(0,i.jsx)(n.td,{children:"Bundle agent project for deployment"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["The CLI reads configuration from ",(0,i.jsx)(n.code,{children:"x-skynet.config.ts"})," (or ",(0,i.jsx)(n.code,{children:".js"}),", ",(0,i.jsx)(n.code,{children:".json"}),") at the project root."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"types-package-x-skynettypes",children:["Types Package (",(0,i.jsx)(n.code,{children:"@x-skynet/types"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Shared TypeScript types used across all packages. Key interfaces:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Core agent config\ninterface AgentConfig {\n  name: string;\n  description?: string;\n  model: string;\n  systemPrompt: string;\n  plugins?: XSkynetPlugin[];\n  memory?: MemoryAdapter;\n  maxRetries?: number;\n  timeout?: number;\n}\n\n// Plugin interface (see Plugin Development guide)\ninterface XSkynetPlugin {\n  id: string;\n  name: string;\n  version: string;\n  initialize(context: PluginContext): Promise<void>;\n  execute(input: PluginInput): Promise<PluginOutput>;\n  teardown?(): Promise<void>;\n}\n\n// Message format\ninterface AgentMessage {\n  id: string;\n  from?: string;\n  to: string;\n  content: string;\n  metadata?: Record<string, unknown>;\n  timestamp: Date;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"plugin-system",children:"Plugin System"}),"\n",(0,i.jsxs)(n.p,{children:["Plugins are the extension points of X-Skynet. They follow a ",(0,i.jsx)(n.strong,{children:"middleware-style"})," execution model:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Message Input\n     \u2193\n[Plugin 1: Auth/Rate Limit]\n     \u2193\n[Plugin 2: Memory Retrieval]\n     \u2193\n[Plugin 3: Tool Execution]\n     \u2193\n[Plugin 4: LLM Provider]   \u2190 required\n     \u2193\n[Plugin 5: Output Transform]\n     \u2193\nResponse Output\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Each plugin receives the current ",(0,i.jsx)(n.code,{children:"PluginInput"})," and can:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pass through unchanged"}),"\n",(0,i.jsx)(n.li,{children:"Augment the input (e.g., add context)"}),"\n",(0,i.jsx)(n.li,{children:"Short-circuit and return a result immediately"}),"\n",(0,i.jsx)(n.li,{children:"Transform the output"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"data-flow",children:"Data Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"User/Caller\n    \u2502\n    \u2502 AgentMessage\n    \u25bc\nRuntime.send()\n    \u2502\n    \u251c\u2500\u25ba MessageBus (routing)\n    \u2502       \u2502\n    \u2502       \u25bc\n    \u2502   Agent.process()\n    \u2502       \u2502\n    \u2502       \u25bc\n    \u2502   PluginChain.execute()\n    \u2502       \u2502\n    \u2502       \u251c\u2500\u25ba MemoryPlugin (load context)\n    \u2502       \u251c\u2500\u25ba ToolPlugin (execute tools)\n    \u2502       \u251c\u2500\u25ba LLMProviderPlugin (call model)\n    \u2502       \u2514\u2500\u25ba PostProcessPlugin (format output)\n    \u2502       \u2502\n    \u2502       \u25bc\n    \u2502   AgentResponse\n    \u2502\n    \u25bc\nCaller receives AgentResponse\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"design-principles",children:"Design Principles"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Composability over configuration"})," \u2014 Build complex behavior by chaining simple plugins"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Provider agnostic"})," \u2014 No vendor lock-in; swap LLM providers by swapping plugins"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type safety first"})," \u2014 All interfaces are TypeScript-typed end to end"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Minimal core, rich ecosystem"})," \u2014 Keep the core small; everything else is a plugin"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Observable by default"})," \u2014 Events emitted at every lifecycle stage for observability"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>c,x:()=>l});var t=s(6540);const i={},r=t.createContext(i);function c(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);